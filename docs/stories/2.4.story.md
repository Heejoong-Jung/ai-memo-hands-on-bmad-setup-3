# Story 2.4: 노트 수정

## Status

Done

---

## Story

**As a** 로그인한 사용자,  
**I want** 작성한 노트의 제목과 본문을 수정할 수 있기를,  
**so that** 잘못 작성된 내용을 바로잡거나 추가 정보를 기록할 수 있다.

---

## Acceptance Criteria

1. 로그인한 사용자만 노트 수정 페이지에 접근할 수 있다
2. 노트 상세 페이지(/notes/[id])의 "수정" 버튼을 클릭하면 수정 페이지로 이동한다
3. 노트 수정 페이지는 `/notes/[id]/edit` 경로에 존재한다
4. 수정 페이지에는 기존 제목과 본문이 미리 채워져 있다 (pre-filled)
5. 제목과 본문을 자유롭게 수정할 수 있다
6. 제목은 필수 항목이며, 비어 있으면 저장할 수 없다
7. 본문은 선택 항목이며, 비어 있어도 저장할 수 있다
8. "저장" 버튼을 클릭하면 수정 사항이 DB에 반영된다
9. 저장 성공 시 노트 상세 페이지(/notes/[id])로 자동 이동한다
10. 저장 실패 시 명확한 에러 메시지가 표시된다
11. "취소" 버튼을 클릭하면 수정을 중단하고 노트 상세 페이지로 돌아간다
12. 다른 사용자의 노트는 수정할 수 없다 (권한 확인)
13. 존재하지 않는 노트 ID로 접근 시 404 에러 페이지가 표시된다
14. 페이지는 모바일/데스크탑 모두에서 정상 작동한다 (반응형)
15. 로딩 중 상태를 명확히 표시한다
16. updated_at 필드가 자동으로 현재 시각으로 업데이트된다

---

## Tasks / Subtasks

- [x] Task 1: 노트 수정 페이지 UI 구현 (AC: 3, 4, 5, 14)
  - [x] 동적 라우트 페이지 생성 (`app/notes/[id]/edit/page.tsx`)
  - [x] 폼 레이아웃 구현
    - [x] 제목 입력 필드 (기존 값 pre-filled)
    - [x] 본문 입력 필드 (기존 값 pre-filled, textarea)
    - [x] 저장/취소 버튼
  - [x] shadcn/ui 컴포넌트 활용 (Input, Textarea, Button, Label)
  - [x] Tailwind CSS를 사용한 반응형 레이아웃
  - [x] 클라이언트 컴포넌트로 구현 (폼 상태 관리 필요)

- [x] Task 2: 노트 수정 Server Action 구현 (AC: 8, 10, 12, 16)
  - [x] Server Action 확장 (`app/notes/actions.ts`)
  - [x] `updateNoteAction` 함수 구현
    - [x] 사용자 인증 확인 (Supabase Auth)
    - [x] 노트 ID, 제목, 본문 파라미터 검증
    - [x] Drizzle ORM을 사용하여 노트 업데이트 (`lib/db/notes.ts`의 `updateNote` 함수 생성)
    - [x] 사용자 스코프 권한 적용 (소유자만 수정 가능)
    - [x] updated_at 자동 업데이트 (현재 시각)
  - [x] 에러 핸들링 및 로깅

- [x] Task 3: DB 레이어 노트 업데이트 함수 구현 (AC: 8, 12, 16)
  - [x] `lib/db/notes.ts`에 `updateNote` 함수 추가 (이미 구현되어 있음)
  - [x] Drizzle ORM의 `.update().set().where()` 사용
  - [x] 사용자 ID와 노트 ID 모두 WHERE 조건에 포함 (권한 스코프)
  - [x] updated_at 필드 자동 업데이트
  - [x] 업데이트된 행이 없으면 null 반환 (권한 없음 또는 노트 없음)

- [x] Task 4: 페이지 레벨 데이터 로딩 및 에러 처리 (AC: 1, 12, 13, 15)
  - [x] Server Component에서 노트 데이터 로딩 (기존 `getNoteById` 활용)
  - [x] 노트가 없거나 권한이 없을 때 404 페이지 표시
  - [x] Next.js `notFound()` 함수 활용
  - [x] 인증되지 않은 사용자는 로그인 페이지로 리다이렉트

- [x] Task 5: 클라이언트 컴포넌트 폼 구현 (AC: 5, 6, 7, 9, 11)
  - [x] 클라이언트 컴포넌트 생성 (`app/notes/[id]/edit/form.tsx`)
  - [x] 폼 상태 관리 (React useState)
    - [x] 제목 상태
    - [x] 본문 상태
    - [x] 로딩 상태
    - [x] 에러 상태
  - [x] 제목 필수 검증 (클라이언트 측)
  - [x] "저장" 버튼 클릭 핸들러
    - [x] `updateNoteAction` 호출
    - [x] 성공 시 `/notes/[id]`로 이동 (router.push)
    - [x] 실패 시 에러 메시지 표시
  - [x] "취소" 버튼 클릭 핸들러
    - [x] `/notes/[id]`로 이동 (router.push)

- [x] Task 6: 노트 상세 페이지 "수정" 버튼 활성화 (AC: 2)
  - [x] `app/notes/[id]/page.tsx` 수정
  - [x] "수정" 버튼 활성화 (disabled 제거)
  - [x] Link 추가: `/notes/[id]/edit`

- [x] Task 7: 클라이언트 측 폼 검증 (AC: 6, 7)
  - [x] 제목 빈 값 검증
  - [x] 제목 길이 제한 검증 (maxLength 200)
  - [x] 본문 길이 제한 검증 (maxLength 50000)
  - [x] 검증 실패 시 명확한 에러 메시지 표시

- [x] Task 8: 테스트 작성 (AC: 전체)
  - [x] Server Action `updateNoteAction` 단위 테스트
    - [x] 성공 케이스: 노트 수정 성공
    - [x] 실패 케이스: 존재하지 않는 노트 ID
    - [x] 실패 케이스: 다른 사용자의 노트 수정 시도
    - [x] 실패 케이스: 인증되지 않은 사용자
    - [x] 실패 케이스: 제목 빈 값
    - [x] 데이터베이스 에러 테스트
  - [x] DB 함수 `updateNote` 단위 테스트
    - [x] 성공 케이스: 노트 업데이트 성공, updated_at 자동 업데이트 확인
    - [x] 실패 케이스: 다른 사용자의 노트 (권한 스코프)
    - [x] 실패 케이스: 존재하지 않는 노트
  - [x] UI 컴포넌트 렌더링 테스트
    - [x] 폼 렌더링 (제목, 본문 필드)
    - [x] 기존 값 pre-filled 확인
    - [x] 저장/취소 버튼 렌더링 확인
    - [x] 제목 필수 검증 동작 확인

---

## Dev Notes

### 기술 스택 및 아키텍처 컨텍스트

**프레임워크 및 라우팅**
- Next.js App Router 사용 (`/app` 디렉토리 구조)
- 동적 라우트: `app/notes/[id]/edit/page.tsx`
- Server Actions로 서버 로직 구현
- 클라이언트 컴포넌트로 폼 상태 관리 (useFormState, useState 또는 React Hook Form)
[Source: docs/architecture.md#1-기술-스택]

**데이터베이스 및 ORM**
- Drizzle ORM을 사용한 데이터 처리
- `lib/db/notes.ts`에 `updateNote(noteId, userId, data)` 함수 추가 필요
- Supabase Postgres 데이터베이스
- 사용자 ID 스코프 적용 필수 (notes.user_id)
- updated_at 필드 자동 업데이트 (SQL `NOW()` 또는 JavaScript `new Date()`)
[Source: docs/architecture.md#1-기술-스택, docs/architecture.md#3-보안]

**인증 및 권한**
- Supabase Auth로 사용자 인증 확인
- Notes: 사용자 ID 스코프로 소유자만 CRUD 가능
- 로그인하지 않은 사용자 접근 차단
- 다른 사용자의 노트 수정 시도 시 권한 에러 반환 또는 404 처리
[Source: docs/architecture.md#3-보안]

**UI 컴포넌트 및 스타일링**
- shadcn/ui 컴포넌트 라이브러리 사용 (Input, Textarea, Button, Label 등)
- Tailwind CSS로 스타일링
- Apple/Notion 수준의 직관적이고 미니멀한 UX 지향
[Source: docs/architecture.md#1-기술-스택]

**데이터 모델**
- notes 테이블: id, user_id, title, content, created_at, updated_at
- Story 2.0에서 이미 정의된 스키마 사용
[Source: docs/architecture.md#2-데이터-모델]

### 이전 스토리에서의 주요 인사이트

**Story 2.0 (Drizzle ORM 셋업):**
- `lib/db/notes.ts`에 `createNote`, `getNoteById`, `getNotesByUserId` 함수 이미 구현됨
- `updateNote` 함수는 아직 구현되지 않았으므로 이번 스토리에서 추가 필요
- Drizzle ORM의 `.update().set().where()` 메서드 사용
- 사용자 스코프를 적용한 WHERE 조건: `eq(notesTable.id, noteId), eq(notesTable.userId, userId)`
[Source: Story 2.0 Dev Agent Record]

**Story 2.1 (노트 생성):**
- 클라이언트 컴포넌트로 폼 구현 (`app/notes/new/form.tsx`)
- React useState로 폼 상태 관리
- Server Action (`createNoteAction`) 호출 패턴 확립
- 폼 제출 후 성공 시 리다이렉트 (`router.push('/notes')`)
- 에러 처리 및 로딩 상태 관리 패턴 확립
[Source: Story 2.1 Dev Agent Record]

**Story 2.2 (노트 목록 조회):**
- 노트 목록 페이지에서 노트 카드 클릭 시 `/notes/[id]`로 이동
- 노트 수정 후 목록에 수정된 내용이 반영되어야 함
[Source: Story 2.2 Dev Agent Record]

**Story 2.3 (노트 상세 조회):**
- `app/notes/[id]/page.tsx`에 "수정" 버튼이 이미 구현되어 있으나 disabled 상태
- 이번 스토리에서 "수정" 버튼 활성화 및 `/notes/[id]/edit`로 링크 연결
- 노트 조회 로직 (`getNoteById`) 재사용 가능
- 인증 및 권한 확인 패턴 확립됨
[Source: Story 2.3 Dev Agent Record]

### 파일 위치 및 구조

**새로 생성할 파일:**
- `/app/notes/[id]/edit/page.tsx` - 노트 수정 페이지 (Server Component)
- `/app/notes/[id]/edit/form.tsx` - 노트 수정 폼 (Client Component)
- `/app/notes/[id]/edit/page.test.tsx` - 노트 수정 페이지 테스트

**수정할 파일:**
- `/app/notes/actions.ts` - `updateNoteAction` 추가
- `/app/notes/actions.test.ts` - updateNoteAction 테스트 추가
- `/lib/db/notes.ts` - `updateNote` 함수 추가
- `/lib/db/notes.test.ts` - updateNote 함수 테스트 추가
- `/app/notes/[id]/page.tsx` - "수정" 버튼 활성화 및 링크 추가

**기존 파일 활용:**
- `/lib/db/notes.ts` - `getNoteById` 함수 사용 (노트 조회)
- `/lib/supabase/server.ts` - 사용자 인증 확인
- `/components/ui/*` - shadcn/ui 컴포넌트

### 구현 가이드라인

**노트 업데이트 DB 함수 예시:**

```typescript
// lib/db/notes.ts
export async function updateNote(
  noteId: string,
  userId: string,
  data: { title: string; content: string }
): Promise<Note | null> {
  const result = await db
    .update(notesTable)
    .set({
      title: data.title,
      content: data.content,
      updatedAt: new Date(), // 또는 sql`NOW()`
    })
    .where(
      and(
        eq(notesTable.id, noteId),
        eq(notesTable.userId, userId)
      )
    )
    .returning();

  return result[0] || null;
}
```

**노트 수정 Server Action 예시:**

```typescript
'use server';

import { createServerClient } from '@/lib/supabase/server';
import { updateNote } from '@/lib/db/notes';
import { redirect } from 'next/navigation';

export async function updateNoteAction(
  noteId: string,
  formData: { title: string; content: string }
) {
  const supabase = createServerClient();
  
  // 사용자 인증 확인
  const { data: { user }, error: authError } = await supabase.auth.getUser();
  
  if (authError || !user) {
    return { error: '인증되지 않은 사용자입니다.' };
  }
  
  // 제목 검증
  if (!formData.title || formData.title.trim() === '') {
    return { error: '제목을 입력해주세요.' };
  }
  
  try {
    // 노트 업데이트
    const updatedNote = await updateNote(noteId, user.id, {
      title: formData.title,
      content: formData.content,
    });
    
    if (!updatedNote) {
      return { error: '노트를 찾을 수 없거나 수정 권한이 없습니다.' };
    }
    
    return { success: true, note: updatedNote };
  } catch (error) {
    console.error('노트 수정 에러:', error);
    return { error: '노트를 수정하는 중 오류가 발생했습니다.' };
  }
}
```

**노트 수정 폼 컴포넌트 구조 예시:**

```typescript
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { updateNoteAction } from '@/app/notes/actions';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Label } from '@/components/ui/label';

export default function EditNoteForm({ 
  noteId, 
  initialTitle, 
  initialContent 
}: { 
  noteId: string; 
  initialTitle: string; 
  initialContent: string; 
}) {
  const [title, setTitle] = useState(initialTitle);
  const [content, setContent] = useState(initialContent);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const router = useRouter();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);
    setError(null);

    const result = await updateNoteAction(noteId, { title, content });

    if (result.error) {
      setError(result.error);
      setIsLoading(false);
    } else {
      router.push(`/notes/${noteId}`);
    }
  };

  const handleCancel = () => {
    router.push(`/notes/${noteId}`);
  };

  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      <div>
        <Label htmlFor="title">제목</Label>
        <Input
          id="title"
          value={title}
          onChange={(e) => setTitle(e.target.value)}
          placeholder="노트 제목을 입력하세요"
          required
        />
      </div>
      <div>
        <Label htmlFor="content">내용</Label>
        <Textarea
          id="content"
          value={content}
          onChange={(e) => setContent(e.target.value)}
          placeholder="노트 내용을 입력하세요"
          rows={10}
        />
      </div>
      {error && <p className="text-red-500 text-sm">{error}</p>}
      <div className="flex gap-2">
        <Button type="submit" disabled={isLoading}>
          {isLoading ? '저장 중...' : '저장'}
        </Button>
        <Button type="button" variant="outline" onClick={handleCancel}>
          취소
        </Button>
      </div>
    </form>
  );
}
```

**페이지 컴포넌트 구조 예시:**

```typescript
import { createServerClient } from '@/lib/supabase/server';
import { getNoteById } from '@/lib/db/notes';
import { notFound, redirect } from 'next/navigation';
import EditNoteForm from './form';

export default async function EditNotePage({ 
  params 
}: { 
  params: { id: string } 
}) {
  const supabase = createServerClient();
  
  // 인증 확인
  const { data: { user } } = await supabase.auth.getUser();
  if (!user) {
    redirect('/auth/login');
  }
  
  // 노트 조회
  const note = await getNoteById(params.id, user.id);
  
  // 노트가 없거나 권한이 없으면 404
  if (!note) {
    notFound();
  }
  
  return (
    <div className="max-w-4xl mx-auto p-4">
      <h1 className="text-2xl font-bold mb-4">노트 수정</h1>
      <EditNoteForm 
        noteId={note.id} 
        initialTitle={note.title} 
        initialContent={note.content} 
      />
    </div>
  );
}
```

**UI 레이아웃 가이드:**
- 제목 입력: Input 컴포넌트, 1줄
- 본문 입력: Textarea 컴포넌트, 10-15줄 높이, 자동 크기 조절 (선택)
- 저장/취소 버튼: 폼 하단, flex gap-2
- 에러 메시지: 폼 하단, 빨간색 텍스트
- 로딩 중: 버튼 disabled, "저장 중..." 텍스트

**에러 처리:**
- 제목 빈 값: "제목을 입력해주세요."
- 인증 에러: 자동 로그인 페이지 리다이렉트
- 권한 없음: "노트를 찾을 수 없거나 수정 권한이 없습니다."
- 조회 에러: "노트를 수정하는 중 오류가 발생했습니다."

**UX 고려사항:**
- 기존 제목/본문이 자동으로 채워져야 함 (pre-filled)
- 취소 버튼 클릭 시 확인 없이 바로 이동 (변경 사항 손실 경고는 향후 개선)
- 저장 중 버튼 disabled 및 로딩 텍스트 표시
- 저장 성공 시 자동으로 상세 페이지로 이동
- 에러 발생 시 명확한 메시지 표시 및 폼 유지 (사용자가 수정 재시도 가능)

**반응형 레이아웃:**
- 모바일 (< 768px): 전체 너비, 적절한 패딩
- 태블릿/데스크탑 (>= 768px): max-width 제한 (예: max-w-4xl), 중앙 정렬

### 의존성

**선행 스토리:**
- Story 1.1, 1.2, 1.3 (사용자 인증) - 완료
- Story 2.0 (Drizzle ORM 셋업) - 완료
- Story 2.1 (노트 생성) - 완료 (폼 패턴 재사용)
- Story 2.3 (노트 상세 조회) - 완료 ("수정" 버튼에서 진입)

**후속 스토리:**
- Story 2.5: 노트 삭제 (상세 페이지에서 삭제 버튼 클릭)

### Testing

**테스트 프레임워크:**
- Vitest + React Testing Library (이미 설정됨)
[Source: 프로젝트 구조]

**단위 테스트:**
- `updateNoteAction` Server Action 테스트
  - 성공 케이스: 노트 수정 성공 (제목, 본문 업데이트)
  - 실패 케이스: 존재하지 않는 노트 ID
  - 실패 케이스: 다른 사용자의 노트 수정 시도
  - 실패 케이스: 인증되지 않은 사용자
  - 실패 케이스: 제목 빈 값
  - 데이터베이스 에러 처리

- `updateNote` DB 함수 테스트
  - 성공 케이스: 노트 업데이트 성공
  - updated_at 자동 업데이트 확인
  - 실패 케이스: 다른 사용자의 노트 (null 반환)
  - 실패 케이스: 존재하지 않는 노트 (null 반환)

**컴포넌트 테스트:**
- 노트 수정 페이지 렌더링 테스트
  - 폼 렌더링 확인 (제목, 본문 필드)
  - 기존 값 pre-filled 확인
  - 저장/취소 버튼 렌더링 확인
  - 제목 필수 검증 동작 확인
  - 제목 변경 후 저장 동작 확인

**통합 테스트:**
- 노트 수정 전체 플로우 테스트
  - 페이지 로드 → 기존 값 표시
  - 제목/본문 수정 → 저장 클릭 → 상세 페이지 이동
  - 취소 클릭 → 상세 페이지 이동
  - 404 케이스 → notFound() 호출 확인

**테스트 케이스:**
1. **updateNoteAction**
   - 성공: 노트 수정 성공 (제목, 본문 업데이트, updated_at 자동 업데이트)
   - 실패: 존재하지 않는 노트 ID
   - 실패: 다른 사용자의 노트
   - 실패: 인증되지 않은 사용자
   - 실패: 제목 빈 값

2. **updateNote DB 함수**
   - 성공: 노트 업데이트 (title, content, updated_at)
   - 실패: 다른 사용자의 노트 (null 반환)
   - 실패: 존재하지 않는 노트 (null 반환)

3. **노트 수정 페이지**
   - 폼 렌더링 (제목, 본문 필드)
   - 기존 값 pre-filled
   - 저장/취소 버튼 동작
   - 404 처리

**테스트 실행:**
- `pnpm test` - 전체 테스트 suite 실행
- `pnpm test app/notes/[id]/edit` - 노트 수정 페이지 테스트만 실행

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-14 | 1.0 | 스토리 2.4 초안 생성 | Bob (Scrum Master) |
| 2025-10-14 | 2.0 | 노트 수정 기능 구현 완료 - 모든 AC 충족, 148개 테스트 통과 | James (Developer) |

---

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5

### Debug Log References

- 테스트 실행 결과: 148개 테스트 모두 통과
  - 신규 테스트: app/notes/actions.test.ts - updateNoteAction 8개 테스트 추가
  - 신규 테스트: app/notes/[id]/edit/page.test.tsx - 5개 테스트
  - 기존 테스트 업데이트: app/notes/[id]/page.test.tsx - 수정 버튼 활성화 테스트 수정
- 전체 회귀 테스트: 기존 135개 + 신규 13개 = 148개 모두 통과

### Completion Notes List

- 모든 Acceptance Criteria 충족:
  - AC 1: 페이지 레벨 인증 확인 구현 (로그인 안 한 사용자는 /auth/login으로 리다이렉트)
  - AC 2: 노트 상세 페이지의 "수정" 버튼 클릭 시 수정 페이지로 이동
  - AC 3: `/notes/[id]/edit` 경로에 노트 수정 페이지 구현
  - AC 4: 수정 페이지에 기존 제목과 본문이 미리 채워짐 (pre-filled)
  - AC 5: 제목과 본문을 자유롭게 수정 가능
  - AC 6: 제목은 필수 항목 (required, 빈 값 검증)
  - AC 7: 본문은 선택 항목 (빈 값 허용)
  - AC 8: "저장" 버튼 클릭 시 수정 사항이 DB에 반영
  - AC 9: 저장 성공 시 노트 상세 페이지로 자동 이동 (router.push + refresh)
  - AC 10: 저장 실패 시 명확한 에러 메시지 표시
  - AC 11: "취소" 버튼 클릭 시 노트 상세 페이지로 돌아감
  - AC 12: 다른 사용자의 노트는 수정 불가 (권한 확인, null 반환 → 404)
  - AC 13: 존재하지 않는 노트 ID 접근 시 404 에러 페이지
  - AC 14: 반응형 레이아웃 (max-w-3xl, 중앙 정렬)
  - AC 15: 로딩 중 상태 표시 ("저장 중...", disabled)
  - AC 16: updated_at 필드 자동 업데이트 (new Date())

- 기술적 구현 세부사항:
  - **Task 3**: `lib/db/notes.ts`의 `updateNote` 함수가 이미 구현되어 있었음 (Story 2.0에서 미리 추가됨)
  - **Task 2**: `updateNoteAction` Server Action 추가 (제목/본문 검증, 길이 제한, 인증, 권한 확인)
  - **Task 5**: 클라이언트 폼 컴포넌트 구현 (useState로 상태 관리, 에러 처리, 로딩 상태)
  - **Task 1 & 4**: Server Component 페이지 구현 (getNoteById 활용, notFound() 처리)
  - **Task 6**: 노트 상세 페이지의 수정 버튼 활성화 (Link로 /notes/[id]/edit 연결)
  - **Task 7**: 클라이언트/서버 양측 검증 (maxLength, required, trim)
  - **Task 8**: 포괄적인 테스트 작성 (updateNoteAction 8개, edit page 5개, 기존 테스트 1개 수정)

- UI/UX 개선사항:
  - Story 2.1의 노트 생성 폼과 일관된 디자인 (Card, Input, Textarea, Button)
  - 실시간 글자 수 카운터 표시 (제목 200자, 본문 50,000자)
  - 저장 중 버튼 disabled 및 "저장 중..." 텍스트 표시
  - 에러 발생 시 빨간색 배경의 에러 메시지 표시
  - 취소 버튼은 outline variant로 시각적 구분
  - router.refresh()로 저장 후 캐시 갱신

- 테스트 커버리지:
  - updateNoteAction 테스트 8개 (인증, 검증, 성공, 실패, DB 에러)
  - updateNote DB 함수 테스트 3개 (Story 2.0에서 이미 작성됨)
  - edit 페이지 테스트 5개 (인증, 404, pre-filled, 권한 스코프)
  - 노트 상세 페이지 테스트 수정 1개 (수정 버튼 활성화 확인)
  - 모든 테스트 케이스 통과 (148개)

### File List

**신규 생성:**
- `app/notes/[id]/edit/page.tsx` - 노트 수정 페이지 (Server Component)
- `app/notes/[id]/edit/form.tsx` - 노트 수정 폼 (Client Component)
- `app/notes/[id]/edit/page.test.tsx` - 노트 수정 페이지 테스트 (5개 테스트)

**수정:**
- `app/notes/actions.ts` - `updateNoteAction` Server Action 추가, import 확장
- `app/notes/actions.test.ts` - updateNoteAction 테스트 8개 추가
- `app/notes/[id]/page.tsx` - "수정" 버튼 활성화 및 Link 추가
- `app/notes/[id]/page.test.tsx` - 수정 버튼 활성화 테스트로 수정
- `docs/stories/2.4.story.md` - 스토리 상태 및 Dev Agent Record 업데이트

**기존 활용:**
- `lib/db/notes.ts` - `updateNote`, `getNoteById` 함수 (이미 구현됨)

---

## QA Results

_[QA Agent가 작성]_

