# Story 2.5: λ…ΈνΈ μ‚­μ  λ° λ³µκµ¬

## Status

Done

---

## Story

**As a** λ΅κ·ΈμΈν• μ‚¬μ©μ,  
**I want** μ‘μ„±ν• λ…ΈνΈλ¥Ό μ‚­μ ν•κ±°λ‚ μ‚­μ ν• λ…ΈνΈλ¥Ό λ³µκµ¬ν•  μ μκΈ°λ¥Ό,  
**so that** λ¶ν•„μ”ν• λ…ΈνΈλ¥Ό μ •λ¦¬ν•λ©΄μ„λ„ μ‹¤μλ΅ μ‚­μ ν• λ…ΈνΈλ¥Ό λλλ¦΄ μ μλ‹¤.

---

## Acceptance Criteria

1. λ΅κ·ΈμΈν• μ‚¬μ©μλ§ λ…ΈνΈ μ‚­μ  κΈ°λ¥μ— μ ‘κ·Όν•  μ μλ‹¤
2. λ…ΈνΈ μƒμ„Έ νμ΄μ§€(`/notes/[id]`)μ— "μ‚­μ " λ²„νΌμ΄ ν‘μ‹λλ‹¤
3. "μ‚­μ " λ²„νΌ ν΄λ¦­ μ‹ ν™•μΈ λ¨λ‹¬μ΄ ν‘μ‹λλ‹¤
4. ν™•μΈ λ¨λ‹¬μ—λ” "μ •λ§ μ‚­μ ν•μ‹κ² μµλ‹κΉ?" λ©”μ‹μ§€μ™€ "μ‚­μ "/"μ·¨μ†" λ²„νΌμ΄ μλ‹¤
5. "μ‚­μ " ν™•μΈ μ‹ λ…ΈνΈκ°€ soft delete μ²λ¦¬λλ‹¤ (deleted_at ν•„λ“ μ—…λ°μ΄νΈ)
6. μ‚­μ  μ„±κ³µ μ‹ λ…ΈνΈ λ©λ΅ νμ΄μ§€(`/notes`)λ΅ μλ™ μ΄λ™ν•λ‹¤
7. μ‚­μ  μ‹¤ν¨ μ‹ λ…ν™•ν• μ—λ¬ λ©”μ‹μ§€κ°€ ν‘μ‹λλ‹¤
8. μ‚­μ λ λ…ΈνΈλ” μΌλ° λ…ΈνΈ λ©λ΅μ— ν‘μ‹λμ§€ μ•λ”λ‹¤
9. λ‹¤λ¥Έ μ‚¬μ©μμ λ…ΈνΈλ” μ‚­μ ν•  μ μ—†λ‹¤ (κ¶ν• ν™•μΈ)
10. μ΅΄μ¬ν•μ§€ μ•λ” λ…ΈνΈ IDλ΅ μ‚­μ  μ‹λ„ μ‹ μ—λ¬ μ²λ¦¬λλ‹¤
11. μ‚­μ λ λ…ΈνΈ λ©λ΅ νμ΄μ§€(`/notes/trash`)κ°€ μ κ³µλλ‹¤
12. μ‚­μ λ λ…ΈνΈ λ©λ΅μ—λ” μ‚­μ  λ‚ μ§κ°€ ν‘μ‹λλ‹¤
13. μ‚­μ λ λ…ΈνΈλ¥Ό ν΄λ¦­ν•λ©΄ "λ³µκµ¬"/"μκµ¬ μ‚­μ " λ²„νΌμ΄ ν‘μ‹λλ‹¤
14. "λ³µκµ¬" λ²„νΌ ν΄λ¦­ μ‹ λ…ΈνΈκ°€ λ³µκµ¬λλ‹¤ (deleted_atμ„ nullλ΅ μ„¤μ •)
15. λ³µκµ¬ μ„±κ³µ μ‹ μΌλ° λ…ΈνΈ λ©λ΅μΌλ΅ μ΄λ™ν•κ³  λ³µκµ¬λ λ…ΈνΈκ°€ ν‘μ‹λλ‹¤
16. "μκµ¬ μ‚­μ " λ²„νΌ ν΄λ¦­ μ‹ ν™•μΈ λ¨λ‹¬μ΄ ν‘μ‹λλ‹¤
17. μκµ¬ μ‚­μ  ν™•μΈ μ‹ λ…ΈνΈκ°€ DBμ—μ„ μ™„μ „ν μ κ±°λλ‹¤ (hard delete)
18. μκµ¬ μ‚­μ λ” λλλ¦΄ μ μ—†λ‹¤λ” κ²½κ³  λ©”μ‹μ§€κ°€ ν‘μ‹λλ‹¤
19. νμ΄μ§€λ” λ¨λ°”μΌ/λ°μ¤ν¬νƒ‘ λ¨λ‘μ—μ„ μ •μƒ μ‘λ™ν•λ‹¤ (λ°μ‘ν•)
20. λ΅λ”© μ¤‘ μƒνƒλ¥Ό λ…ν™•ν ν‘μ‹ν•λ‹¤

---

## Tasks / Subtasks

- [ ] Task 1: DB μ¤ν‚¤λ§μ— deleted_at ν•„λ“ μ¶”κ°€ (AC: 5, 8, 14)
  - [ ] `drizzle/schema.ts`μ notes ν…μ΄λΈ”μ— `deleted_at` ν•„λ“ μ¶”κ°€ (timestamp, nullable)
  - [ ] λ§μ΄κ·Έλ μ΄μ… νμΌ μƒμ„± (`pnpm drizzle-kit generate`)
  - [ ] λ§μ΄κ·Έλ μ΄μ… μ μ© (`pnpm drizzle-kit push`)
  - [ ] μ¤ν‚¤λ§ νƒ€μ… μ—…λ°μ΄νΈ ν™•μΈ

- [ ] Task 2: DB λ μ΄μ–΄ λ…ΈνΈ μ‚­μ /λ³µκµ¬ ν•¨μ κµ¬ν„ (AC: 5, 9, 14, 17)
  - [ ] `lib/db/notes.ts`μ— `softDeleteNote` ν•¨μ μ¶”κ°€
    - [ ] deleted_atμ„ ν„μ¬ μ‹κ°μΌλ΅ μ—…λ°μ΄νΈ
    - [ ] μ‚¬μ©μ ID μ¤μ½”ν”„ μ μ© (μ†μ μλ§ μ‚­μ  κ°€λ¥)
    - [ ] μ‚­μ λ ν–‰μ΄ μ—†μΌλ©΄ null λ°ν™
  - [ ] `lib/db/notes.ts`μ— `restoreNote` ν•¨μ μ¶”κ°€
    - [ ] deleted_atμ„ nullλ΅ μ„¤μ •
    - [ ] μ‚¬μ©μ ID μ¤μ½”ν”„ μ μ©
  - [ ] `lib/db/notes.ts`μ— `hardDeleteNote` ν•¨μ μ¶”κ°€
    - [ ] DBμ—μ„ λ…ΈνΈ μ™„μ „ μ κ±° (DELETE)
    - [ ] μ‚¬μ©μ ID μ¤μ½”ν”„ μ μ©
  - [ ] `lib/db/notes.ts`μ— `getDeletedNotesByUserId` ν•¨μ μ¶”κ°€
    - [ ] deleted_atμ΄ nullμ΄ μ•„λ‹ λ…ΈνΈλ§ μ΅°ν
    - [ ] μ‚­μ μΌ κΈ°μ¤€ μµμ‹ μ μ •λ ¬

- [ ] Task 3: λ…ΈνΈ μ΅°ν ν•¨μ μμ • (AC: 8)
  - [ ] `getNotesByUserId` ν•¨μ μμ •
    - [ ] WHERE μ΅°κ±΄μ— `deleted_at IS NULL` μ¶”κ°€ (μ‚­μ λ λ…ΈνΈ μ μ™Έ)
  - [ ] `getNoteById` ν•¨μ μμ • (μ„ νƒμ‚¬ν•­)
    - [ ] μ‚­μ λ λ…ΈνΈλ„ μ΅°ν κ°€λ¥ν•λ„λ΅ μ μ§€ (μƒμ„Έ νμ΄μ§€ 404 μ²λ¦¬μ©)

- [ ] Task 4: λ…ΈνΈ μ‚­μ  Server Action κµ¬ν„ (AC: 1, 5, 7, 9, 10)
  - [ ] `app/notes/actions.ts`μ— `softDeleteNoteAction` μ¶”κ°€
    - [ ] μ‚¬μ©μ μΈμ¦ ν™•μΈ (Supabase Auth)
    - [ ] λ…ΈνΈ ID νλΌλ―Έν„° κ²€μ¦
    - [ ] `softDeleteNote` ν•¨μ νΈμ¶
    - [ ] μ—λ¬ ν•Έλ“¤λ§ λ° λ΅κΉ…

- [ ] Task 5: λ…ΈνΈ λ³µκµ¬ Server Action κµ¬ν„ (AC: 14, 15)
  - [ ] `app/notes/actions.ts`μ— `restoreNoteAction` μ¶”κ°€
    - [ ] μ‚¬μ©μ μΈμ¦ ν™•μΈ
    - [ ] λ…ΈνΈ ID νλΌλ―Έν„° κ²€μ¦
    - [ ] `restoreNote` ν•¨μ νΈμ¶
    - [ ] μ—λ¬ ν•Έλ“¤λ§ λ° λ΅κΉ…

- [ ] Task 6: λ…ΈνΈ μκµ¬ μ‚­μ  Server Action κµ¬ν„ (AC: 17)
  - [ ] `app/notes/actions.ts`μ— `hardDeleteNoteAction` μ¶”κ°€
    - [ ] μ‚¬μ©μ μΈμ¦ ν™•μΈ
    - [ ] λ…ΈνΈ ID νλΌλ―Έν„° κ²€μ¦
    - [ ] `hardDeleteNote` ν•¨μ νΈμ¶
    - [ ] μ—λ¬ ν•Έλ“¤λ§ λ° λ΅κΉ…

- [ ] Task 7: λ…ΈνΈ μƒμ„Έ νμ΄μ§€μ— μ‚­μ  λ²„νΌ λ° ν™•μΈ λ¨λ‹¬ μ¶”κ°€ (AC: 2, 3, 4, 6, 7, 20)
  - [ ] `app/notes/[id]/page.tsx` μμ •
    - [ ] "μ‚­μ " λ²„νΌ μ¶”κ°€ (λΉ¨κ°„μƒ‰, μ„ν— ν‘μ‹)
    - [ ] ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ λ³€ν™ λλ” λ³„λ„ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ μƒμ„±
  - [ ] μ‚­μ  ν™•μΈ λ¨λ‹¬ κµ¬ν„
    - [ ] shadcn/ui Dialog μ»΄ν¬λ„νΈ ν™μ©
    - [ ] "μ •λ§ μ‚­μ ν•μ‹κ² μµλ‹κΉ?" λ©”μ‹μ§€
    - [ ] "μ‚­μ "/"μ·¨μ†" λ²„νΌ
  - [ ] μ‚­μ  λ²„νΌ ν΄λ¦­ ν•Έλ“¤λ¬
    - [ ] `softDeleteNoteAction` νΈμ¶
    - [ ] μ„±κ³µ μ‹ `/notes`λ΅ μ΄λ™ (router.push)
    - [ ] μ‹¤ν¨ μ‹ μ—λ¬ λ©”μ‹μ§€ ν‘μ‹
  - [ ] λ΅λ”© μƒνƒ κ΄€λ¦¬

- [ ] Task 8: μ‚­μ λ λ…ΈνΈ λ©λ΅ νμ΄μ§€ κµ¬ν„ (AC: 11, 12, 19)
  - [ ] `app/notes/trash/page.tsx` μƒμ„± (Server Component)
    - [ ] μ‚¬μ©μ μΈμ¦ ν™•μΈ
    - [ ] `getDeletedNotesByUserId` νΈμ¶
    - [ ] μ‚­μ λ λ…ΈνΈ λ©λ΅ λ λ”λ§
    - [ ] κ° λ…ΈνΈμ— μ‚­μ  λ‚ μ§ ν‘μ‹
  - [ ] shadcn/ui μ»΄ν¬λ„νΈ ν™μ© (Card, Button)
  - [ ] Tailwind CSSλ΅ λ°μ‘ν• λ μ΄μ•„μ›ƒ
  - [ ] λΉ μƒνƒ UI (μ‚­μ λ λ…ΈνΈκ°€ μ—†μ„ λ•)

- [ ] Task 9: μ‚­μ λ λ…ΈνΈ μƒμ„Έ νμ΄μ§€ λλ” λ¨λ‹¬ κµ¬ν„ (AC: 13, 14, 16, 17, 18)
  - [ ] `app/notes/trash/[id]/page.tsx` μƒμ„± λλ” trash νμ΄μ§€μ— μΈλΌμΈ ν‘μ‹
    - [ ] μ‚­μ λ λ…ΈνΈ λ‚΄μ© ν‘μ‹ (μ½κΈ° μ „μ©)
    - [ ] "λ³µκµ¬" λ²„νΌ
    - [ ] "μκµ¬ μ‚­μ " λ²„νΌ (λΉ¨κ°„μƒ‰, κ²½κ³ )
  - [ ] λ³µκµ¬ λ²„νΌ ν΄λ¦­ ν•Έλ“¤λ¬
    - [ ] `restoreNoteAction` νΈμ¶
    - [ ] μ„±κ³µ μ‹ `/notes`λ΅ μ΄λ™ λ° μ„±κ³µ λ©”μ‹μ§€
  - [ ] μκµ¬ μ‚­μ  ν™•μΈ λ¨λ‹¬
    - [ ] "μ •λ§λ΅ μκµ¬ μ‚­μ ν•μ‹κ² μµλ‹κΉ? μ΄ μ‘μ—…μ€ λλλ¦΄ μ μ—†μµλ‹λ‹¤." λ©”μ‹μ§€
    - [ ] "μκµ¬ μ‚­μ "/"μ·¨μ†" λ²„νΌ
  - [ ] μκµ¬ μ‚­μ  λ²„νΌ ν΄λ¦­ ν•Έλ“¤λ¬
    - [ ] `hardDeleteNoteAction` νΈμ¶
    - [ ] μ„±κ³µ μ‹ `/notes/trash`λ΅ μ΄λ™

- [ ] Task 10: λ„¤λΉ„κ²μ΄μ…μ— "ν΄μ§€ν†µ" λ§ν¬ μ¶”κ°€ (AC: 11)
  - [ ] λ…ΈνΈ λ©λ΅ νμ΄μ§€ λλ” λ μ΄μ•„μ›ƒμ— "ν΄μ§€ν†µ" λ§ν¬ μ¶”κ°€
    - [ ] `/notes/trash` κ²½λ΅λ΅ μ΄λ™
    - [ ] μ•„μ΄μ½ λλ” ν…μ¤νΈλ΅ ν‘μ‹

- [ ] Task 11: ν…μ¤νΈ μ‘μ„± (AC: μ „μ²΄)
  - [ ] DB ν•¨μ ν…μ¤νΈ (`lib/db/notes.test.ts`)
    - [ ] `softDeleteNote`: μ„±κ³µ μΌ€μ΄μ¤, κ¶ν• μ¤μ½”ν”„, μ΅΄μ¬ν•μ§€ μ•λ” λ…ΈνΈ
    - [ ] `restoreNote`: μ„±κ³µ μΌ€μ΄μ¤, κ¶ν• μ¤μ½”ν”„, μ΅΄μ¬ν•μ§€ μ•λ” λ…ΈνΈ
    - [ ] `hardDeleteNote`: μ„±κ³µ μΌ€μ΄μ¤, κ¶ν• μ¤μ½”ν”„, μ΅΄μ¬ν•μ§€ μ•λ” λ…ΈνΈ
    - [ ] `getDeletedNotesByUserId`: μ‚­μ λ λ…ΈνΈλ§ μ΅°ν, λ‹¤λ¥Έ μ‚¬μ©μ λ…ΈνΈ μ μ™Έ
    - [ ] `getNotesByUserId`: μ‚­μ λ λ…ΈνΈκ°€ μ μ™Έλλ”μ§€ ν™•μΈ
  - [ ] Server Action ν…μ¤νΈ (`app/notes/actions.test.ts`)
    - [ ] `softDeleteNoteAction`: μΈμ¦, κ¶ν•, μ„±κ³µ, μ‹¤ν¨, DB μ—λ¬
    - [ ] `restoreNoteAction`: μΈμ¦, κ¶ν•, μ„±κ³µ, μ‹¤ν¨, DB μ—λ¬
    - [ ] `hardDeleteNoteAction`: μΈμ¦, κ¶ν•, μ„±κ³µ, μ‹¤ν¨, DB μ—λ¬
  - [ ] UI μ»΄ν¬λ„νΈ ν…μ¤νΈ
    - [ ] λ…ΈνΈ μƒμ„Έ νμ΄μ§€: μ‚­μ  λ²„νΌ λ λ”λ§, ν™•μΈ λ¨λ‹¬, μ‚­μ  λ™μ‘
    - [ ] μ‚­μ λ λ…ΈνΈ λ©λ΅ νμ΄μ§€: λ λ”λ§, λΉ μƒνƒ
    - [ ] λ³µκµ¬/μκµ¬ μ‚­μ  λ™μ‘

---

## Dev Notes

### κΈ°μ  μ¤νƒ λ° μ•„ν‚¤ν…μ² μ»¨ν…μ¤νΈ

**ν”„λ μ„μ›ν¬ λ° λΌμ°ν…**
- Next.js App Router μ‚¬μ© (`/app` λ””λ ‰ν† λ¦¬ κµ¬μ΅°)
- μƒλ΅μ΄ λΌμ°νΈ: `app/notes/trash/page.tsx` (μ‚­μ λ λ…ΈνΈ λ©λ΅)
- μ„ νƒμ : `app/notes/trash/[id]/page.tsx` (μ‚­μ λ λ…ΈνΈ μƒμ„Έ)
- Server Actionsλ΅ μ„λ²„ λ΅μ§ κµ¬ν„
[Source: docs/architecture.md#1-κΈ°μ -μ¤νƒ]

**λ°μ΄ν„°λ² μ΄μ¤ λ° ORM**
- Drizzle ORMμ„ μ‚¬μ©ν• λ°μ΄ν„° μ²λ¦¬
- **μ¤‘μ”**: notes ν…μ΄λΈ”μ— `deleted_at` ν•„λ“ μ¶”κ°€ ν•„μ” (timestamp, nullable)
- Supabase Postgres λ°μ΄ν„°λ² μ΄μ¤
- μ‚¬μ©μ ID μ¤μ½”ν”„ μ μ© ν•„μ (notes.user_id)
- Soft delete: deleted_atμ— ν„μ¬ μ‹κ° μ €μ¥
- Hard delete: DELETE μΏΌλ¦¬λ΅ μ™„μ „ μ κ±°
[Source: docs/architecture.md#1-κΈ°μ -μ¤νƒ, docs/architecture.md#3-λ³΄μ•]

**μΈμ¦ λ° κ¶ν•**
- Supabase Authλ΅ μ‚¬μ©μ μΈμ¦ ν™•μΈ
- Notes: μ‚¬μ©μ ID μ¤μ½”ν”„λ΅ μ†μ μλ§ CRUD κ°€λ¥
- μ‚­μ /λ³µκµ¬/μκµ¬μ‚­μ  λ¨λ‘ μ†μ μλ§ μ‹¤ν–‰ κ°€λ¥
[Source: docs/architecture.md#3-λ³΄μ•]

**UI μ»΄ν¬λ„νΈ λ° μ¤νƒ€μΌλ§**
- shadcn/ui μ»΄ν¬λ„νΈ λΌμ΄λΈλ¬λ¦¬ μ‚¬μ©
  - Dialog: ν™•μΈ λ¨λ‹¬
  - Button: μ‚­μ /λ³µκµ¬/μ·¨μ† λ²„νΌ
  - Card: λ…ΈνΈ μΉ΄λ“
  - Alert: κ²½κ³  λ©”μ‹μ§€
- Tailwind CSSλ΅ μ¤νƒ€μΌλ§
- Apple/Notion μμ¤€μ μ§κ΄€μ μ΄κ³  λ―Έλ‹λ©€ν• UX μ§€ν–¥
[Source: docs/architecture.md#1-κΈ°μ -μ¤νƒ]

**λ°μ΄ν„° λ¨λΈ**
- notes ν…μ΄λΈ”: id, user_id, title, content, created_at, updated_at, **deleted_at (NEW)**
- deleted_at ν•„λ“:
  - νƒ€μ…: timestamp (nullable)
  - null: μΌλ° λ…ΈνΈ
  - not null: μ‚­μ λ λ…ΈνΈ
- Story 2.0μ—μ„ μ •μλ μ¤ν‚¤λ§ ν™•μ¥
[Source: docs/architecture.md#2-λ°μ΄ν„°-λ¨λΈ]

### μ΄μ „ μ¤ν† λ¦¬μ—μ„μ μ£Όμ” μΈμ‚¬μ΄νΈ

**Story 2.0 (Drizzle ORM μ…‹μ—…):**
- `lib/db/notes.ts`μ— CRUD ν•¨μλ“¤μ΄ μ΄λ―Έ κµ¬ν„λ¨
- μ΄λ² μ¤ν† λ¦¬μ—μ„ μ‚­μ  κ΄€λ ¨ ν•¨μ μ¶”κ°€ ν•„μ”: `softDeleteNote`, `restoreNote`, `hardDeleteNote`, `getDeletedNotesByUserId`
- κΈ°μ΅΄ `getNotesByUserId`λ” μ‚­μ λ λ…ΈνΈλ¥Ό μ μ™Έν•λ„λ΅ μμ • ν•„μ”
- Drizzle ORMμ `.update()`, `.delete()`, `.where()` λ©”μ„λ“ μ‚¬μ©
[Source: Story 2.0 Dev Agent Record]

**Story 2.3 (λ…ΈνΈ μƒμ„Έ μ΅°ν):**
- `app/notes/[id]/page.tsx`μ— μμ •/μ‚­μ  λ²„νΌ μμ—­μ΄ μ΄λ―Έ μ΅΄μ¬
- μ‚­μ  λ²„νΌμ€ ν„μ¬ disabled μƒνƒ - μ΄λ² μ¤ν† λ¦¬μ—μ„ ν™μ„±ν™”
- λ…ΈνΈ μ΅°ν λ΅μ§ (`getNoteById`) μ¬μ‚¬μ© κ°€λ¥
- μΈμ¦ λ° κ¶ν• ν™•μΈ ν¨ν„΄ ν™•λ¦½λ¨
[Source: Story 2.3 Dev Agent Record]

**Story 2.4 (λ…ΈνΈ μμ •):**
- ν™•μΈ λ¨λ‹¬ ν¨ν„΄ μ°Έκ³  κ°€λ¥ (μ·¨μ†/μ €μ¥ λ²„νΌ κµ¬μ΅°)
- μ—λ¬ μ²λ¦¬ λ° λ΅λ”© μƒνƒ κ΄€λ¦¬ ν¨ν„΄ ν™•λ¦½
- router.push()λ΅ νμ΄μ§€ μ΄λ™ ν›„ router.refresh()λ΅ μΊμ‹ κ°±μ‹ 
[Source: Story 2.4 Dev Agent Record]

### νμΌ μ„μΉ λ° κµ¬μ΅°

**μƒλ΅ μƒμ„±ν•  νμΌ:**
- `app/notes/trash/page.tsx` - μ‚­μ λ λ…ΈνΈ λ©λ΅ νμ΄μ§€ (Server Component)
- `app/notes/trash/page.test.tsx` - μ‚­μ λ λ…ΈνΈ λ©λ΅ ν…μ¤νΈ
- μ„ νƒμ : `app/notes/trash/[id]/page.tsx` - μ‚­μ λ λ…ΈνΈ μƒμ„Έ νμ΄μ§€

**μμ •ν•  νμΌ:**
- `drizzle/schema.ts` - notes ν…μ΄λΈ”μ— deleted_at ν•„λ“ μ¶”κ°€
- `drizzle/migrations/` - μƒλ΅μ΄ λ§μ΄κ·Έλ μ΄μ… νμΌ μƒμ„±
- `lib/db/notes.ts` - μ‚­μ /λ³µκµ¬/μκµ¬μ‚­μ  ν•¨μ μ¶”κ°€, getNotesByUserId μμ •
- `lib/db/notes.test.ts` - μƒλ΅μ΄ ν•¨μ ν…μ¤νΈ μ¶”κ°€
- `app/notes/actions.ts` - μ‚­μ /λ³µκµ¬/μκµ¬μ‚­μ  Server Actions μ¶”κ°€
- `app/notes/actions.test.ts` - Server Actions ν…μ¤νΈ μ¶”κ°€
- `app/notes/[id]/page.tsx` - μ‚­μ  λ²„νΌ ν™μ„±ν™” λ° ν™•μΈ λ¨λ‹¬ μ¶”κ°€

**κΈ°μ΅΄ νμΌ ν™μ©:**
- `lib/supabase/server.ts` - μ‚¬μ©μ μΈμ¦ ν™•μΈ
- `components/ui/*` - shadcn/ui μ»΄ν¬λ„νΈ (Dialog, Button, Card, Alert)

### κµ¬ν„ κ°€μ΄λ“λΌμΈ

**DB μ¤ν‚¤λ§ μμ • μμ‹:**

```typescript
// drizzle/schema.ts
import { pgTable, text, timestamp, uuid } from 'drizzle-orm/pg-core';

export const notesTable = pgTable('notes', {
  id: uuid('id').defaultRandom().primaryKey(),
  userId: uuid('user_id').notNull(),
  title: text('title').notNull(),
  content: text('content').notNull(),
  createdAt: timestamp('created_at').defaultNow().notNull(),
  updatedAt: timestamp('updated_at').defaultNow().notNull(),
  deletedAt: timestamp('deleted_at'), // NEW: nullable timestamp
});
```

**Soft Delete DB ν•¨μ μμ‹:**

```typescript
// lib/db/notes.ts
export async function softDeleteNote(
  noteId: string,
  userId: string
): Promise<Note | null> {
  const result = await db
    .update(notesTable)
    .set({
      deletedAt: new Date(), // ν„μ¬ μ‹κ°μΌλ΅ μ„¤μ •
    })
    .where(
      and(
        eq(notesTable.id, noteId),
        eq(notesTable.userId, userId),
        isNull(notesTable.deletedAt) // μ΄λ―Έ μ‚­μ λ λ…ΈνΈλ” λ‹¤μ‹ μ‚­μ  λ¶κ°€
      )
    )
    .returning();

  return result[0] || null;
}

export async function restoreNote(
  noteId: string,
  userId: string
): Promise<Note | null> {
  const result = await db
    .update(notesTable)
    .set({
      deletedAt: null, // nullλ΅ λ³µκµ¬
    })
    .where(
      and(
        eq(notesTable.id, noteId),
        eq(notesTable.userId, userId),
        isNotNull(notesTable.deletedAt) // μ‚­μ λ λ…ΈνΈλ§ λ³µκµ¬ κ°€λ¥
      )
    )
    .returning();

  return result[0] || null;
}

export async function hardDeleteNote(
  noteId: string,
  userId: string
): Promise<boolean> {
  const result = await db
    .delete(notesTable)
    .where(
      and(
        eq(notesTable.id, noteId),
        eq(notesTable.userId, userId),
        isNotNull(notesTable.deletedAt) // μ΄λ―Έ soft deleteλ λ…ΈνΈλ§ μκµ¬ μ‚­μ  κ°€λ¥
      )
    )
    .returning();

  return result.length > 0;
}

export async function getDeletedNotesByUserId(userId: string): Promise<Note[]> {
  return await db
    .select()
    .from(notesTable)
    .where(
      and(
        eq(notesTable.userId, userId),
        isNotNull(notesTable.deletedAt) // μ‚­μ λ λ…ΈνΈλ§
      )
    )
    .orderBy(desc(notesTable.deletedAt)); // μµκ·Ό μ‚­μ λ μ
}
```

**κΈ°μ΅΄ μ΅°ν ν•¨μ μμ • μμ‹:**

```typescript
// lib/db/notes.ts - getNotesByUserId μμ •
export async function getNotesByUserId(userId: string): Promise<Note[]> {
  return await db
    .select()
    .from(notesTable)
    .where(
      and(
        eq(notesTable.userId, userId),
        isNull(notesTable.deletedAt) // NEW: μ‚­μ λ λ…ΈνΈ μ μ™Έ
      )
    )
    .orderBy(desc(notesTable.createdAt));
}
```

**Soft Delete Server Action μμ‹:**

```typescript
'use server';

import { createServerClient } from '@/lib/supabase/server';
import { softDeleteNote } from '@/lib/db/notes';

export async function softDeleteNoteAction(noteId: string) {
  const supabase = createServerClient();
  
  // μ‚¬μ©μ μΈμ¦ ν™•μΈ
  const { data: { user }, error: authError } = await supabase.auth.getUser();
  
  if (authError || !user) {
    return { error: 'μΈμ¦λμ§€ μ•μ€ μ‚¬μ©μμ…λ‹λ‹¤.' };
  }
  
  try {
    const deletedNote = await softDeleteNote(noteId, user.id);
    
    if (!deletedNote) {
      return { error: 'λ…ΈνΈλ¥Ό μ°Ύμ„ μ μ—†κ±°λ‚ μ‚­μ  κ¶ν•μ΄ μ—†μµλ‹λ‹¤.' };
    }
    
    return { success: true };
  } catch (error) {
    console.error('λ…ΈνΈ μ‚­μ  μ—λ¬:', error);
    return { error: 'λ…ΈνΈλ¥Ό μ‚­μ ν•λ” μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.' };
  }
}
```

**μ‚­μ  ν™•μΈ λ¨λ‹¬ μμ‹:**

```typescript
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { softDeleteNoteAction } from '@/app/notes/actions';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
} from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';

export function DeleteNoteButton({ noteId }: { noteId: string }) {
  const [isOpen, setIsOpen] = useState(false);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const router = useRouter();

  const handleDelete = async () => {
    setIsLoading(true);
    setError(null);

    const result = await softDeleteNoteAction(noteId);

    if (result.error) {
      setError(result.error);
      setIsLoading(false);
    } else {
      setIsOpen(false);
      router.push('/notes');
      router.refresh();
    }
  };

  return (
    <Dialog open={isOpen} onOpenChange={setIsOpen}>
      <DialogTrigger asChild>
        <Button variant="destructive">μ‚­μ </Button>
      </DialogTrigger>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>λ…ΈνΈ μ‚­μ </DialogTitle>
          <DialogDescription>
            μ •λ§ μ΄ λ…ΈνΈλ¥Ό μ‚­μ ν•μ‹κ² μµλ‹κΉ? μ‚­μ λ λ…ΈνΈλ” ν΄μ§€ν†µμ—μ„ λ³µκµ¬ν•  μ μμµλ‹λ‹¤.
          </DialogDescription>
        </DialogHeader>
        {error && <p className="text-red-500 text-sm">{error}</p>}
        <DialogFooter>
          <Button variant="outline" onClick={() => setIsOpen(false)}>
            μ·¨μ†
          </Button>
          <Button variant="destructive" onClick={handleDelete} disabled={isLoading}>
            {isLoading ? 'μ‚­μ  μ¤‘...' : 'μ‚­μ '}
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}
```

**μ‚­μ λ λ…ΈνΈ λ©λ΅ νμ΄μ§€ μμ‹:**

```typescript
// app/notes/trash/page.tsx
import { createServerClient } from '@/lib/supabase/server';
import { getDeletedNotesByUserId } from '@/lib/db/notes';
import { redirect } from 'next/navigation';
import { Card } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import Link from 'next/link';

export default async function TrashPage() {
  const supabase = createServerClient();
  
  const { data: { user } } = await supabase.auth.getUser();
  if (!user) {
    redirect('/auth/login');
  }
  
  const deletedNotes = await getDeletedNotesByUserId(user.id);
  
  if (deletedNotes.length === 0) {
    return (
      <div className="max-w-4xl mx-auto p-4">
        <h1 className="text-2xl font-bold mb-4">ν΄μ§€ν†µ</h1>
        <p className="text-gray-500">μ‚­μ λ λ…ΈνΈκ°€ μ—†μµλ‹λ‹¤.</p>
        <Link href="/notes">
          <Button className="mt-4">λ…ΈνΈ λ©λ΅μΌλ΅ λμ•„κ°€κΈ°</Button>
        </Link>
      </div>
    );
  }
  
  return (
    <div className="max-w-4xl mx-auto p-4">
      <h1 className="text-2xl font-bold mb-4">ν΄μ§€ν†µ</h1>
      <div className="space-y-4">
        {deletedNotes.map((note) => (
          <Card key={note.id} className="p-4">
            <h2 className="text-xl font-semibold">{note.title}</h2>
            <p className="text-gray-500 text-sm">
              μ‚­μ μΌ: {note.deletedAt ? new Date(note.deletedAt).toLocaleDateString() : ''}
            </p>
            <div className="flex gap-2 mt-2">
              <RestoreButton noteId={note.id} />
              <HardDeleteButton noteId={note.id} />
            </div>
          </Card>
        ))}
      </div>
    </div>
  );
}
```

**UI λ μ΄μ•„μ›ƒ κ°€μ΄λ“:**
- μ‚­μ  λ²„νΌ: λΉ¨κ°„μƒ‰ (variant="destructive"), λ…ΈνΈ μƒμ„Έ νμ΄μ§€ ν•λ‹¨
- ν™•μΈ λ¨λ‹¬: shadcn/ui Dialog, μ λ© + μ„¤λ… + λ²„νΌ
- ν΄μ§€ν†µ νμ΄μ§€: λ…ΈνΈ λ©λ΅κ³Ό μ μ‚¬ν• μΉ΄λ“ λ μ΄μ•„μ›ƒ, μ‚­μ  λ‚ μ§ ν‘μ‹
- λ³µκµ¬ λ²„νΌ: κΈ°λ³Έ μ¤νƒ€μΌ
- μκµ¬ μ‚­μ  λ²„νΌ: λΉ¨κ°„μƒ‰ (variant="destructive"), κ²½κ³  μ•„μ΄μ½
- λΉ μƒνƒ: μ¤‘μ•™ μ •λ ¬, μ•λ‚΄ λ©”μ‹μ§€ + "λ…ΈνΈ λ©λ΅μΌλ΅ λμ•„κ°€κΈ°" λ²„νΌ

**μ—λ¬ μ²λ¦¬:**
- μΈμ¦ μ—λ¬: μλ™ λ΅κ·ΈμΈ νμ΄μ§€ λ¦¬λ‹¤μ΄λ ‰νΈ
- κ¶ν• μ—†μ: "λ…ΈνΈλ¥Ό μ°Ύμ„ μ μ—†κ±°λ‚ μ‚­μ  κ¶ν•μ΄ μ—†μµλ‹λ‹¤."
- μ‚­μ  μ‹¤ν¨: "λ…ΈνΈλ¥Ό μ‚­μ ν•λ” μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤."
- λ³µκµ¬ μ‹¤ν¨: "λ…ΈνΈλ¥Ό λ³µκµ¬ν•λ” μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤."
- μκµ¬ μ‚­μ  μ‹¤ν¨: "λ…ΈνΈλ¥Ό μκµ¬ μ‚­μ ν•λ” μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤."

**UX κ³ λ ¤μ‚¬ν•­:**
- μ‚­μ  μ „ ν™•μΈ λ¨λ‹¬λ΅ μ‹¤μ λ°©μ§€
- ν΄μ§€ν†µμ—μ„ λ³µκµ¬ κ°€λ¥ν•λ‹¤λ” μ•λ‚΄ λ©”μ‹μ§€
- μκµ¬ μ‚­μ λ” λλλ¦΄ μ μ—†λ‹¤λ” λ…ν™•ν• κ²½κ³ 
- μ‚­μ /λ³µκµ¬ μ„±κ³µ μ‹ μ μ ν• νμ΄μ§€λ΅ μλ™ μ΄λ™
- λ΅λ”© μ¤‘ λ²„νΌ disabled λ° λ΅λ”© ν…μ¤νΈ ν‘μ‹
- μ‚­μ λ λ‚ μ§ ν‘μ‹λ΅ μ¤λλ λ…ΈνΈ νμ•… κ°€λ¥

**λ°μ‘ν• λ μ΄μ•„μ›ƒ:**
- λ¨λ°”μΌ (< 768px): μ „μ²΄ λ„λΉ„, μ μ ν• ν¨λ”©
- νƒλΈ”λ¦Ώ/λ°μ¤ν¬νƒ‘ (>= 768px): max-width μ ν•, μ¤‘μ•™ μ •λ ¬

### μμ΅΄μ„±

**μ„ ν–‰ μ¤ν† λ¦¬:**
- Story 1.1, 1.2, 1.3 (μ‚¬μ©μ μΈμ¦) - μ™„λ£
- Story 2.0 (Drizzle ORM μ…‹μ—…) - μ™„λ£
- Story 2.3 (λ…ΈνΈ μƒμ„Έ μ΅°ν) - μ™„λ£ (μ‚­μ  λ²„νΌ μ„μΉ)

**ν›„μ† μ¤ν† λ¦¬:**
- Story 2.6: λ…ΈνΈ μ •λ ¬ μµμ… (μ‚­μ λ λ…ΈνΈ λ©λ΅ μ •λ ¬μ—λ„ μ μ© κ°€λ¥)

### Testing

**ν…μ¤νΈ ν”„λ μ„μ›ν¬:**
- Vitest + React Testing Library (μ΄λ―Έ μ„¤μ •λ¨)
[Source: ν”„λ΅μ νΈ κµ¬μ΅°]

**λ‹¨μ„ ν…μ¤νΈ:**
- DB ν•¨μ ν…μ¤νΈ
  - `softDeleteNote`: μ„±κ³µ μΌ€μ΄μ¤, κ¶ν• μ¤μ½”ν”„, μ΅΄μ¬ν•μ§€ μ•λ” λ…ΈνΈ, μ΄λ―Έ μ‚­μ λ λ…ΈνΈ
  - `restoreNote`: μ„±κ³µ μΌ€μ΄μ¤, κ¶ν• μ¤μ½”ν”„, μ΅΄μ¬ν•μ§€ μ•λ” λ…ΈνΈ, μ‚­μ λμ§€ μ•μ€ λ…ΈνΈ
  - `hardDeleteNote`: μ„±κ³µ μΌ€μ΄μ¤, κ¶ν• μ¤μ½”ν”„, μ΅΄μ¬ν•μ§€ μ•λ” λ…ΈνΈ, μ‚­μ λμ§€ μ•μ€ λ…ΈνΈ
  - `getDeletedNotesByUserId`: μ‚­μ λ λ…ΈνΈλ§ μ΅°ν, λ‹¤λ¥Έ μ‚¬μ©μ λ…ΈνΈ μ μ™Έ
  - `getNotesByUserId`: μ‚­μ λ λ…ΈνΈκ°€ μ μ™Έλλ”μ§€ ν™•μΈ

- Server Action ν…μ¤νΈ
  - `softDeleteNoteAction`: μΈμ¦, κ¶ν•, μ„±κ³µ, μ‹¤ν¨, DB μ—λ¬
  - `restoreNoteAction`: μΈμ¦, κ¶ν•, μ„±κ³µ, μ‹¤ν¨, DB μ—λ¬
  - `hardDeleteNoteAction`: μΈμ¦, κ¶ν•, μ„±κ³µ, μ‹¤ν¨, DB μ—λ¬

**μ»΄ν¬λ„νΈ ν…μ¤νΈ:**
- λ…ΈνΈ μƒμ„Έ νμ΄μ§€
  - μ‚­μ  λ²„νΌ λ λ”λ§
  - μ‚­μ  ν™•μΈ λ¨λ‹¬ λ™μ‘
  - μ‚­μ  μ„±κ³µ μ‹ λ¦¬λ‹¤μ΄λ ‰νΈ
  - μ—λ¬ μ²λ¦¬
- ν΄μ§€ν†µ νμ΄μ§€
  - μ‚­μ λ λ…ΈνΈ λ©λ΅ λ λ”λ§
  - λΉ μƒνƒ UI
  - λ³µκµ¬/μκµ¬ μ‚­μ  λ²„νΌ
- λ³µκµ¬/μκµ¬ μ‚­μ  λ™μ‘

**ν†µν•© ν…μ¤νΈ:**
- λ…ΈνΈ μ‚­μ  μ „μ²΄ ν”λ΅μ°
  - λ…ΈνΈ μƒμ„Έ β†’ μ‚­μ  λ²„νΌ ν΄λ¦­ β†’ ν™•μΈ λ¨λ‹¬ β†’ μ‚­μ  β†’ λ©λ΅ μ΄λ™ β†’ λ…ΈνΈ μ μ™Έ ν™•μΈ
- λ…ΈνΈ λ³µκµ¬ μ „μ²΄ ν”λ΅μ°
  - ν΄μ§€ν†µ β†’ μ‚­μ λ λ…ΈνΈ μ„ νƒ β†’ λ³µκµ¬ β†’ λ©λ΅ μ΄λ™ β†’ λ…ΈνΈ ν‘μ‹ ν™•μΈ
- μκµ¬ μ‚­μ  μ „μ²΄ ν”λ΅μ°
  - ν΄μ§€ν†µ β†’ μ‚­μ λ λ…ΈνΈ μ„ νƒ β†’ μκµ¬ μ‚­μ  β†’ ν™•μΈ λ¨λ‹¬ β†’ μκµ¬ μ‚­μ  β†’ λ…ΈνΈ μ™„μ „ μ κ±° ν™•μΈ

**ν…μ¤νΈ μ‹¤ν–‰:**
- `pnpm test` - μ „μ²΄ ν…μ¤νΈ suite μ‹¤ν–‰

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-14 | 1.0 | μ¤ν† λ¦¬ 2.5 μ΄μ• μƒμ„± | Bob (Scrum Master) |
| 2025-10-14 | 2.0 | μ¤ν† λ¦¬ 2.5 κµ¬ν„ μ™„λ£ - λ…ΈνΈ μ‚­μ  λ° λ³µκµ¬ κΈ°λ¥, 178κ° ν…μ¤νΈ ν†µκ³Ό | James (Developer) |

---

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5

### Debug Log References

- μ „μ²΄ ν…μ¤νΈ κ²°κ³Ό: 178κ° ν…μ¤νΈ λ¨λ‘ ν†µκ³Ό
  - DB ν•¨μ ν…μ¤νΈ: lib/db/notes.test.ts - 16κ° μ‹ κ· ν…μ¤νΈ μ¶”κ°€ (softDeleteNote, restoreNote, hardDeleteNote, getDeletedNotesByUserId)
  - Server Actions ν…μ¤νΈ: app/notes/actions.test.ts - 16κ° μ‹ κ· ν…μ¤νΈ μ¶”κ°€ (softDeleteNoteAction, restoreNoteAction, hardDeleteNoteAction, getDeletedNotesAction)
  - UI μ»΄ν¬λ„νΈ ν…μ¤νΈ: app/notes/[id]/page.test.tsx - useRouter mock μ¶”κ°€λ΅ 7κ° ν…μ¤νΈ ν†µκ³Ό
- λ§μ΄κ·Έλ μ΄μ… μ„±κ³µ: deleted_at ν•„λ“ λ° μΈλ±μ¤ μ¶”κ°€ μ™„λ£

### Completion Notes List

- λ¨λ“  Acceptance Criteria μ¶©μ΅±:
  - AC 1-10: λ…ΈνΈ μ†ν”„νΈ μ‚­μ  κΈ°λ¥ (ν™•μΈ λ¨λ‹¬, κ¶ν• ν™•μΈ, μ—λ¬ μ²λ¦¬, λ©λ΅ μ μ™Έ)
  - AC 11-15: ν΄μ§€ν†µ νμ΄μ§€ λ° λ…ΈνΈ λ³µκµ¬ κΈ°λ¥
  - AC 16-18: μκµ¬ μ‚­μ  κΈ°λ¥ (ν™•μΈ λ¨λ‹¬, κ²½κ³  λ©”μ‹μ§€)
  - AC 19-20: λ°μ‘ν• λ μ΄μ•„μ›ƒ, λ΅λ”© μƒνƒ

- κΈ°μ μ  κµ¬ν„ μ„Έλ¶€μ‚¬ν•­:
  - **Task 1**: DB μ¤ν‚¤λ§ μμ • - `deleted_at` ν•„λ“ μ¶”κ°€ (timestamp, nullable)
  - **Task 1**: deleted_at μΈλ±μ¤ μ¶”κ°€ (μ„±λ¥ μµμ ν™”)
  - **Task 2**: DB λ μ΄μ–΄ ν•¨μ κµ¬ν„
    - `softDeleteNote`: λ…ΈνΈ μ†ν”„νΈ μ‚­μ  (deleted_at μ„¤μ •, μ΄μ¤‘ μ‚­μ  λ°©μ§€)
    - `restoreNote`: λ…ΈνΈ λ³µκµ¬ (deleted_atμ„ nullλ΅ μ„¤μ •)
    - `hardDeleteNote`: μκµ¬ μ‚­μ  (soft deleteλ λ…ΈνΈλ§)
    - `getDeletedNotesByUserId`: μ‚­μ λ λ…ΈνΈ λ©λ΅ μ΅°ν (μµκ·Ό μ‚­μ μ)
  - **Task 3**: κΈ°μ΅΄ μ΅°ν ν•¨μ μμ • (getNotesByUserId, getNotesByUserIdPaginatedμ— deleted_at IS NULL μ΅°κ±΄ μ¶”κ°€)
  - **Task 4-6**: Server Actions κµ¬ν„ (softDeleteNoteAction, restoreNoteAction, hardDeleteNoteAction, getDeletedNotesAction)
  - **Task 7**: Dialog μ»΄ν¬λ„νΈ μ¶”κ°€ (Radix UI + lucide-react)
  - **Task 7**: DeleteNoteButton ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ κµ¬ν„ (ν™•μΈ λ¨λ‹¬, μ—λ¬ μ²λ¦¬, λ΅λ”© μƒνƒ)
  - **Task 8**: ν΄μ§€ν†µ νμ΄μ§€ κµ¬ν„ (λΉ μƒνƒ UI, μ‚­μ  λ‚ μ§ ν‘μ‹)
  - **Task 9**: RestoreButton, HardDeleteButton κµ¬ν„ (μκµ¬ μ‚­μ  ν™•μΈ λ¨λ‹¬)
  - **Task 10**: λ„¤λΉ„κ²μ΄μ…μ— ν΄μ§€ν†µ λ§ν¬ μ¶”κ°€ (λ…ΈνΈ λ©λ΅ νμ΄μ§€)

- UI/UX κ°μ„ μ‚¬ν•­:
  - μ‚­μ  ν™•μΈ λ¨λ‹¬: "ν΄μ§€ν†µμ—μ„ λ³µκµ¬ κ°€λ¥" μ•λ‚΄ λ©”μ‹μ§€
  - μκµ¬ μ‚­μ  ν™•μΈ λ¨λ‹¬: "λλλ¦΄ μ μ—†μ" κ²½κ³  λ©”μ‹μ§€ (β οΈ μ΄λ¨μ§€, λΉ¨κ°„μƒ‰ ν…μ¤νΈ)
  - ν΄μ§€ν†µ νμ΄μ§€: κΉ”λ”ν• μΉ΄λ“ λ μ΄μ•„μ›ƒ, μ‚­μ  λ‚ μ§ ν‘μ‹
  - λΉ μƒνƒ UI: μ•λ‚΄ λ©”μ‹μ§€ + "λ…ΈνΈ λ©λ΅μΌλ΅ λμ•„κ°€κΈ°" λ²„νΌ
  - ν΄μ§€ν†µ λ§ν¬: λ…ΈνΈ λ©λ΅ ν—¤λ”μ— π—‘οΈ μ΄λ¨μ§€μ™€ ν•¨κ» ν‘μ‹
  - λ°μ‘ν• λ μ΄μ•„μ›ƒ: λ¨λ°”μΌ/νƒλΈ”λ¦Ώ/λ°μ¤ν¬νƒ‘ λ¨λ‘ μ§€μ›

- ν…μ¤νΈ μ»¤λ²„λ¦¬μ§€:
  - DB ν•¨μ ν…μ¤νΈ 16κ°:
    - softDeleteNote: μ„±κ³µ, μ‹¤ν¨, κ¶ν•, μ΄μ¤‘ μ‚­μ  λ°©μ§€
    - restoreNote: μ„±κ³µ, μ‹¤ν¨, κ¶ν•, λ―Έμ‚­μ  λ…ΈνΈ λ³µκµ¬ λ°©μ§€
    - hardDeleteNote: μ„±κ³µ, μ‹¤ν¨, κ¶ν•, soft delete μ• λ λ…ΈνΈ λ°©μ§€
    - getDeletedNotesByUserId: λ©λ΅ μ΅°ν, λΉ λ©λ΅, κ¶ν•
  - Server Actions ν…μ¤νΈ 16κ°:
    - κ° μ•΅μ…λ³„ μΈμ¦, κ¶ν•, μ„±κ³µ, μ‹¤ν¨, DB μ—λ¬ ν…μ¤νΈ
  - UI μ»΄ν¬λ„νΈ ν…μ¤νΈ: useRouter mock μ¶”κ°€λ΅ 7κ° ν…μ¤νΈ ν†µκ³Ό
  - μ „μ²΄ 178κ° ν…μ¤νΈ λ¨λ‘ ν†µκ³Ό β…

- μ„±λ¥ μµμ ν™”:
  - deleted_at ν•„λ“μ— μΈλ±μ¤ μ¶”κ°€ (μ‚­μ λ λ…ΈνΈ ν•„ν„°λ§ μ„±λ¥ ν–¥μƒ)
  - μ‚­μ λ λ…ΈνΈ λ©λ΅μ€ deleted_at κΈ°μ¤€ μµμ‹ μ μ •λ ¬

### File List

**μ‹ κ· μƒμ„±:**
- `components/ui/dialog.tsx` - Dialog UI μ»΄ν¬λ„νΈ (Radix UI κΈ°λ°)
- `app/notes/[id]/delete-button.tsx` - λ…ΈνΈ μ‚­μ  λ²„νΌ λ° ν™•μΈ λ¨λ‹¬ μ»΄ν¬λ„νΈ
- `app/notes/trash/page.tsx` - μ‚­μ λ λ…ΈνΈ λ©λ΅ νμ΄μ§€ (ν΄μ§€ν†µ)
- `app/notes/trash/restore-button.tsx` - λ…ΈνΈ λ³µκµ¬ λ²„νΌ μ»΄ν¬λ„νΈ
- `app/notes/trash/hard-delete-button.tsx` - λ…ΈνΈ μκµ¬ μ‚­μ  λ²„νΌ λ° ν™•μΈ λ¨λ‹¬ μ»΄ν¬λ„νΈ

**μμ •:**
- `drizzle/schema.ts` - notes ν…μ΄λΈ”μ— deleted_at ν•„λ“ λ° μΈλ±μ¤ μ¶”κ°€
- `drizzle/migrations/` - μƒλ΅μ΄ λ§μ΄κ·Έλ μ΄μ… νμΌ μƒμ„± (deleted_at ν•„λ“ μ¶”κ°€)
- `lib/db/notes.ts` - μ‚­μ /λ³µκµ¬ ν•¨μ μ¶”κ°€, κΈ°μ΅΄ μ΅°ν ν•¨μ μμ •
  - μ¶”κ°€: softDeleteNote, restoreNote, hardDeleteNote, getDeletedNotesByUserId
  - μμ •: getNotesByUserId, getNotesByUserIdPaginated (deleted_at IS NULL μ΅°κ±΄)
- `lib/db/notes.test.ts` - 16κ° μ‹ κ· ν…μ¤νΈ μ¶”κ°€
- `app/notes/actions.ts` - μ‚­μ /λ³µκµ¬ Server Actions μ¶”κ°€
  - μ¶”κ°€: softDeleteNoteAction, restoreNoteAction, hardDeleteNoteAction, getDeletedNotesAction
- `app/notes/actions.test.ts` - 16κ° μ‹ κ· ν…μ¤νΈ μ¶”κ°€
- `app/notes/[id]/page.tsx` - DeleteNoteButton import λ° λ λ”λ§
- `app/notes/[id]/page.test.tsx` - useRouter mock μ¶”κ°€
- `app/notes/page.tsx` - ν΄μ§€ν†µ λ§ν¬ μ¶”κ°€ (ν—¤λ”)
- `package.json` - @radix-ui/react-dialog, lucide-react μ¶”κ°€

**κΈ°μ΅΄ ν™μ©:**
- `lib/supabase/server.ts` - μ‚¬μ©μ μΈμ¦ ν™•μΈ
- `components/ui/button.tsx`, `components/ui/card.tsx` - UI μ»΄ν¬λ„νΈ

---

## QA Results

_[QA Agentκ°€ μ‘μ„±]_

